diff -U3 -r src.orig/preferences-skeleton.h src/preferences-skeleton.h
--- src.orig/preferences-skeleton.h	2008-03-10 23:20:06.000000000 -0500
+++ src/preferences-skeleton.h	2012-12-19 12:52:10.311910582 -0600
@@ -247,6 +247,10 @@
 "           clips=\"16711935\"" // 00ff00ff
 "           masks=\"65535\"/>\n" // 0x0000ffff
 "    <group id=\"svgoutput\" usenamedcolors=\"0\" numericprecision=\"8\" minimumexponent=\"-8\" inlineattrs=\"0\" indent=\"2\"/>\n"
+"    <group id=\"externalresources\">\n"
+"      <group id=\"xml\" "
+"           allow_net_access=\"0\"/>\n"
+"    </group>\n"
 "    <group id=\"forkgradientvectors\" value=\"1\"/>\n"
 "    <group id=\"grids\""
 "      no_emphasize_when_zoomedout=\"0\">\n"
diff -U3 -r src.orig/ui/dialog/ocaldialogs.cpp src/ui/dialog/ocaldialogs.cpp
--- src.orig/ui/dialog/ocaldialogs.cpp	2008-03-10 23:20:43.000000000 -0500
+++ src/ui/dialog/ocaldialogs.cpp	2012-12-19 12:53:56.081013991 -0600
@@ -446,9 +446,15 @@
     xmlDoc *doc = NULL;
     xmlNode *root_element = NULL;
 
-    doc = xmlReadIO ((xmlInputReadCallback) vfs_read_callback,
-        (xmlInputCloseCallback) gnome_vfs_close, from_handle, uri.c_str(), NULL,
-        XML_PARSE_RECOVER);
+    int parse_options = XML_PARSE_RECOVER + XML_PARSE_NOWARNING + XML_PARSE_NOERROR;  // do not use XML_PARSE_NOENT ! see bug lp:1025185
+    Inkscape::Preferences *prefs = Inkscape::Preferences::get();
+    bool allowNetAccess = prefs->getBool("/options/externalresources/xml/allow_net_access", false);
+    if (!allowNetAccess) {
+        parse_options |= XML_PARSE_NONET;
+    }
+
+    doc = xmlReadMemory(data, (int) length, xml_uri.c_str(), NULL, parse_options);
+
     if (doc == NULL) {
         sp_ui_error_dialog(_("Server supplied malformed Clip Art feed"));
         g_warning("Failed to parse %s\n", uri.c_str());
diff -U3 -r src.orig/xml/repr-io.cpp src/xml/repr-io.cpp
--- src.orig/xml/repr-io.cpp	2008-03-10 23:19:47.000000000 -0500
+++ src/xml/repr-io.cpp	2012-12-19 12:56:41.825176036 -0600
@@ -274,12 +274,19 @@
         XmlSource src;
 
         if ( (src.setFile(filename) == 0) ) {
+            int parse_options = XML_PARSE_HUGE; // do not use XML_PARSE_NOENT ! see bug lp:1025185
+            Inkscape::Preferences *prefs = Inkscape::Preferences::get();
+            bool allowNetAccess = prefs->getBool("/options/externalresources/xml/allow_net_access", false);
+            if (!allowNetAccess) {
+                parse_options |= XML_PARSE_NONET;
+            }
+
             doc = xmlReadIO( XmlSource::readCb,
                              XmlSource::closeCb,
                              &src,
                              localFilename,
                              src.getEncoding(),
-                             XML_PARSE_NOENT );
+                             parse_options);
         }
     }
 
